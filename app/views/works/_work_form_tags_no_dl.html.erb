<fieldset class="work meta">
  <legend><%= ts('Tags') %></legend>
  <h3 class="landmark heading"><%= ts('Tags') %></h3>

  <p class="note"><%= ts('Tags are comma separated, %{max} characters per tag.', :max => ArchiveConfig.TAG_MAX) %></p>

  <div class="rating required">
    <label for="work_rating_string"><%= Rating::NAME %>*</label>
    <%= link_to_help "rating-help" %>
    <%= collection_select :work,
                          :rating_string,
                          Rating.defaults_by_severity,
                          :name,
                          :name, 
                          include_blank: include_blank, 
                          selected: include_blank ? nil :   
                                    rating_selected(@work) %>
  </div>

  <div class="warning required">
    <fieldset class="warnings">
      <legend><%= ArchiveWarning::NAME.pluralize %>* <%= link_to_help "warning-help" %></legend>
      <ul>
        <% for tag in ArchiveWarning.canonical.by_name %>
          <li>
            <%= check_box_tag "work[archive_warning_strings][]", tag.name, include_blank ? false : check_archive_warning(@work, tag), :id => "work_archive_warning_strings_#{tag.id}" %>
            <%= label_tag "work_archive_warning_strings_#{tag.id}", tag.name %>
          </li>
        <% end %>
      </ul>
    </fieldset>
  </div>

  <div class="fandom required">
    <label for="work_fandom" title="<%= ts('fandoms') %>"><%= Fandom::NAME.pluralize %>*</label>
    <%= link_to_help "fandom-help" %>
    <%= text_field_tag "work[fandom_string]", include_blank ? "" : @work.fandom_string, 
                        autocomplete_options('fandom', 
                        :id => "work_fandom",
                        :title => ts('fandoms')) %>
    <p class="footnote"><%= ts('If this is the first work for a fandom, it may not show up in the fandoms page for a day or two.') %></p>
  </div>

  <div class="category">
    <fieldset>
      <legend><%= Category::NAME.pluralize %><%= link_to_help "categories-help" %></legend>
      <ul>
        <% for tag in Category.canonical.by_name.sort %>
          <li>
            <%= check_box_tag "work[category_string][]", tag.name, include_blank ? false : @work.category_strings.include?(tag.name), :id => "work_category_string_#{tag.id}" %>
            <%= label_tag "work_category_string_#{tag.id}", tag.name %>
          </li>
        <% end %> 
      </ul>
    </fieldset>
  </div>

  <div class="relationship">
    <label for="work_relationship"><%= Relationship::NAME.pluralize %></label>
    <%= link_to_help "relationships-help" %>
    <%= text_field_tag "work[relationship_string]", include_blank ? "" : @work.relationship_string, 
                        autocomplete_options("relationship_in_fandom",
                          :id => "work_relationship",
                          :title => ts('relationships'),
                          :autocomplete_live_params => 'fandom=work_fandom') %>
  </div>

  <div class="character">
    <label for="work_character"><%= Character::NAME.pluralize %></label>
    <%= link_to_help "characters-help" %>
    <%= text_field_tag "work[character_string]", include_blank ? "" : @work.character_string, 
                        autocomplete_options('character_in_fandom', 
                          :id => "work_character",
                          :title => ts('characters'),
                          :autocomplete_live_params => 'fandom=work_fandom') %>
  </div>

  <div class="freeform">
    <label for="work_freeform"><%= Freeform::NAME %></label>
    <%= link_to_help "additional-tags-help" %>
    <%= text_field_tag "work[freeform_string]", include_blank ? "" : @work.freeform_string, autocomplete_options('freeform',
                        :id => "work_freeform",
                        :title => ts('additional tags')) %>
  </div>
</fieldset>
